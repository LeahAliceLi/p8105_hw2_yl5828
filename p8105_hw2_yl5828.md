p8105_hw2_yl5828
================
Leah Li yl5828
2025-10-01

``` r
# Load dataset
library(tidyverse)
library(dplyr)
library(readr)
library(lubridate)
```

## Problem 1

### Clean file pols-month

``` r
pols_month_df =
  read_csv("./fivethirtyeight_datasets/pols-month.csv", na = c("NA", ".", "")) %>%
  janitor::clean_names() %>%
  separate(mon, into = c("year", "month", "day"), sep = "-") %>%
  mutate(
    month=recode(month, `01` ="January", `02`= "February", `03`= "March", `04`= "April", `05`= "May",`06`= "June",`07`= "July",`08`= "August",`09`= "September",`10`= "October",`11`= "November",`12`= "December"),
    president = if_else(prez_gop == 1, "gop", "dem"),
    year = as.numeric(year)
         )%>%
  select(-prez_dem, -prez_gop, -day)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
pols_month_df
```

    ## # A tibble: 822 × 9
    ##     year month     gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <dbl> <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1  1947 January        23      51     253      23      45     198 dem      
    ##  2  1947 February       23      51     253      23      45     198 dem      
    ##  3  1947 March          23      51     253      23      45     198 dem      
    ##  4  1947 April          23      51     253      23      45     198 dem      
    ##  5  1947 May            23      51     253      23      45     198 dem      
    ##  6  1947 June           23      51     253      23      45     198 dem      
    ##  7  1947 July           23      51     253      23      45     198 dem      
    ##  8  1947 August         23      51     253      23      45     198 dem      
    ##  9  1947 September      23      51     253      23      45     198 dem      
    ## 10  1947 October        23      51     253      23      45     198 dem      
    ## # ℹ 812 more rows

### Clean file snp

``` r
snp_df =
  read_csv("./fivethirtyeight_datasets/snp.csv", na = c("NA", ".", "")) %>%
  janitor::clean_names() %>%
  separate(date, into = c("month", "day", "year"), sep = "/") %>%
  mutate(
    month=recode(month, `1` ="January", `2`= "February", `3`= "March", `4`= "April", `5`= "May",`6`= "June",`7`= "July",`8`= "August",`9`= "September",`10`= "October",`11`= "November",`12`= "December"),
    year = if_else(year > 25, 1900 + as.numeric(year), 2000 + as.numeric(year)),
    month = factor(month, levels = month.name, ordered = TRUE))%>%
  select(year, month, close) %>%
  arrange(year,month)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
snp_df
```

    ## # A tibble: 787 × 3
    ##     year month     close
    ##    <dbl> <ord>     <dbl>
    ##  1  1950 January    17.0
    ##  2  1950 February   17.2
    ##  3  1950 March      17.3
    ##  4  1950 April      18.0
    ##  5  1950 May        18.8
    ##  6  1950 June       17.7
    ##  7  1950 July       17.8
    ##  8  1950 August     18.4
    ##  9  1950 September  19.5
    ## 10  1950 October    19.5
    ## # ℹ 777 more rows

### Clean file unemployment

``` r
unemployment_df = 
  read_csv("./fivethirtyeight_datasets/unemployment.csv", na = c("NA", ".", "")) %>%
  janitor::clean_names() %>%
  pivot_longer(
    jan:dec,
    names_to = "month", 
    values_to = "unemployment") %>%
  mutate(
    month=recode(month, `jan` ="January", `feb`= "February", `mar`= "March", `apr`= "April", `may`= "May",`jun`= "June",`jul`= "July",`aug`= "August",`sep`= "September",`oct`= "October",`nov`= "November",`dec`= "December" ))
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unemployment_df
```

    ## # A tibble: 816 × 3
    ##     year month     unemployment
    ##    <dbl> <chr>            <dbl>
    ##  1  1948 January            3.4
    ##  2  1948 February           3.8
    ##  3  1948 March              4  
    ##  4  1948 April              3.9
    ##  5  1948 May                3.5
    ##  6  1948 June               3.6
    ##  7  1948 July               3.6
    ##  8  1948 August             3.9
    ##  9  1948 September          3.8
    ## 10  1948 October            3.7
    ## # ℹ 806 more rows

### Join datasets

``` r
q1join_df = 
  inner_join(pols_month_df, snp_df, by = c("year", "month")) %>%
  inner_join(unemployment_df, by = c("year", "month"))

q1join_df
```

    ## # A tibble: 786 × 11
    ##     year month   gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <dbl> <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1  1950 January      18      44     177      29      57     269 dem        17.0
    ##  2  1950 Februa…      18      44     177      29      57     269 dem        17.2
    ##  3  1950 March        18      44     177      29      57     269 dem        17.3
    ##  4  1950 April        18      44     177      29      57     269 dem        18.0
    ##  5  1950 May          18      44     177      29      57     269 dem        18.8
    ##  6  1950 June         18      44     177      29      57     269 dem        17.7
    ##  7  1950 July         18      44     177      29      57     269 dem        17.8
    ##  8  1950 August       18      44     177      29      57     269 dem        18.4
    ##  9  1950 Septem…      18      44     177      29      57     269 dem        19.5
    ## 10  1950 October      18      44     177      29      57     269 dem        19.5
    ## # ℹ 776 more rows
    ## # ℹ 1 more variable: unemployment <dbl>

### Dataset Explanation

The dataset `pols_month_df` include variables as follows: year, month,
gov_gop, sen_gop, rep_gop, gov_dem, sen_dem, rep_dem, president. And the
dataset has **822** rows and **9** columns.

The dataset `snp_df` include variables as follows: year, month, close.
And the dataset has **787** rows and **3** columns.

The dataset `unemployment_df` include variables as follows: year, month,
unemployment. And the dataset has **816** rows and **3** columns.

The resulting dataset `q1join_df` include variables as follows: year,
month, gov_gop, sen_gop, rep_gop, gov_dem, sen_dem, rep_dem, president,
close, unemployment. And the dataset has **786** rows and **11**
columns. The range of years is (**1950, 2015**).

## Problem 2

### Clean dataset Mr.Trash Wheel

``` r
mr.trash_df = 
  readxl::read_excel("./Mr.Trash Wheel/202509 Trash Wheel Collection Data.xlsx", sheet="Mr. Trash Wheel", range="A2:M709", na = c("NA", ".", ""))%>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
  mutate(
    sports_balls = as.integer(round(sports_balls)),
    year = as.numeric(year),
    wheel_name = "Mr.Trash"
  )

mr.trash_df
```

    ## # A tibble: 707 × 14
    ##    dumpster month  year date                weight_tons volume_cubic_yards
    ##       <dbl> <chr> <dbl> <dttm>                    <dbl>              <dbl>
    ##  1        1 May    2014 2014-05-16 00:00:00        4.31                 18
    ##  2        2 May    2014 2014-05-16 00:00:00        2.74                 13
    ##  3        3 May    2014 2014-05-16 00:00:00        3.45                 15
    ##  4        4 May    2014 2014-05-17 00:00:00        3.1                  15
    ##  5        5 May    2014 2014-05-17 00:00:00        4.06                 18
    ##  6        6 May    2014 2014-05-20 00:00:00        2.71                 13
    ##  7        7 May    2014 2014-05-21 00:00:00        1.91                  8
    ##  8        8 May    2014 2014-05-28 00:00:00        3.7                  16
    ##  9        9 June   2014 2014-06-05 00:00:00        2.52                 14
    ## 10       10 June   2014 2014-06-11 00:00:00        3.76                 18
    ## # ℹ 697 more rows
    ## # ℹ 8 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, wheel_name <chr>

### Clean dataset Professor Trash Wheel

``` r
professor_trash_df = 
  readxl::read_excel("./Mr.Trash Wheel/202509 Trash Wheel Collection Data.xlsx", sheet="Professor Trash Wheel", range="A2:M134", na = c("NA", ".", ""))%>%
  janitor::clean_names() %>%
  drop_na(dumpster)%>%
  mutate(wheel_name = "Professor")

professor_trash_df
```

    ## # A tibble: 132 × 14
    ##    dumpster month     year date                weight_tons volume_cubic_yards
    ##       <dbl> <chr>    <dbl> <dttm>                    <dbl>              <dbl>
    ##  1        1 January   2017 2017-01-02 00:00:00        1.79                 15
    ##  2        2 January   2017 2017-01-30 00:00:00        1.58                 15
    ##  3        3 February  2017 2017-02-26 00:00:00        2.32                 18
    ##  4        4 February  2017 2017-02-26 00:00:00        3.72                 15
    ##  5        5 February  2017 2017-02-28 00:00:00        1.45                 15
    ##  6        6 March     2017 2017-03-30 00:00:00        1.71                 15
    ##  7        7 April     2017 2017-04-01 00:00:00        1.82                 15
    ##  8        8 April     2017 2017-04-20 00:00:00        2.37                 15
    ##  9        9 May       2017 2017-05-10 00:00:00        2.64                 15
    ## 10       10 May       2017 2017-05-26 00:00:00        2.78                 15
    ## # ℹ 122 more rows
    ## # ℹ 8 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, homes_powered <dbl>, wheel_name <chr>

### Clean dataset Gwynnda Trash Wheel

``` r
gwynnda_trash_df = 
  readxl::read_excel("./Mr.Trash Wheel/202509 Trash Wheel Collection Data.xlsx", sheet="Gwynns Falls Trash Wheel", range="A2:L351", na = c("NA", ".", ""))%>%
  janitor::clean_names() %>%
  drop_na(dumpster)%>%
  mutate(wheel_name = "Gwynnda")

gwynnda_trash_df
```

    ## # A tibble: 349 × 13
    ##    dumpster month   year date                weight_tons volume_cubic_yards
    ##       <dbl> <chr>  <dbl> <dttm>                    <dbl>              <dbl>
    ##  1        1 July    2021 2021-07-03 00:00:00        0.93                 15
    ##  2        2 July    2021 2021-07-07 00:00:00        2.26                 15
    ##  3        3 July    2021 2021-07-07 00:00:00        1.62                 15
    ##  4        4 July    2021 2021-07-16 00:00:00        1.76                 15
    ##  5        5 July    2021 2021-07-30 00:00:00        1.53                 15
    ##  6        6 August  2021 2021-08-11 00:00:00        2.06                 15
    ##  7        7 August  2021 2021-08-14 00:00:00        1.9                  15
    ##  8        8 August  2021 2021-08-16 00:00:00        2.16                 15
    ##  9        9 August  2021 2021-08-16 00:00:00        2.6                  15
    ## 10       10 August  2021 2021-08-17 00:00:00        3.21                 15
    ## # ℹ 339 more rows
    ## # ℹ 7 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, plastic_bags <dbl>, wrappers <dbl>,
    ## #   homes_powered <dbl>, wheel_name <chr>

### Join the three wheels together

``` r
all_wheels_combined <- bind_rows(mr.trash_df, professor_trash_df, gwynnda_trash_df)

all_wheels_combined
```

    ## # A tibble: 1,188 × 15
    ##    dumpster month  year date                weight_tons volume_cubic_yards
    ##       <dbl> <chr> <dbl> <dttm>                    <dbl>              <dbl>
    ##  1        1 May    2014 2014-05-16 00:00:00        4.31                 18
    ##  2        2 May    2014 2014-05-16 00:00:00        2.74                 13
    ##  3        3 May    2014 2014-05-16 00:00:00        3.45                 15
    ##  4        4 May    2014 2014-05-17 00:00:00        3.1                  15
    ##  5        5 May    2014 2014-05-17 00:00:00        4.06                 18
    ##  6        6 May    2014 2014-05-20 00:00:00        2.71                 13
    ##  7        7 May    2014 2014-05-21 00:00:00        1.91                  8
    ##  8        8 May    2014 2014-05-28 00:00:00        3.7                  16
    ##  9        9 June   2014 2014-06-05 00:00:00        2.52                 14
    ## 10       10 June   2014 2014-06-11 00:00:00        3.76                 18
    ## # ℹ 1,178 more rows
    ## # ℹ 9 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, wheel_name <chr>, homes_powered <dbl>

### Dataset Explanation

``` r
prof_weight <- all_wheels_combined %>%
  filter(wheel_name == "Professor") %>%
  summarise(total_weight = sum(weight_tons, na.rm = TRUE)) %>%
  pull(total_weight)

print(prof_weight)
```

    ## [1] 282.26

The total weight of trash collected by Professor Trash Wheel was
**282.26** tons.

``` r
gwynnda_butts <- all_wheels_combined %>%
  filter(wheel_name == "Gwynnda", month == "June", year == 2022) %>%
  summarise(total_butts = sum(cigarette_butts, na.rm = TRUE)) %>%
  pull(total_butts)

print(gwynnda_butts)
```

    ## [1] 18120

The total number of cigarette butts collected by Gwynnda in June of 2022
was **18,120**.

The dataset contains **1188** observations of trash collection events
for 3 different trash wheels, spanning from 2014 to 2025. Each
observation records the contents of a single dumpster, identified by the
name of the trash wheel (e.g., ‘Mr. Trash Wheel’, ‘Gwynnda’). The
dataset `mr.trash_df` include **707** dumpsters. The dataset
`professor_trash_df` include **132** dumpsters. The dataset
`gwynnda_trash_df` include **349** dumpsters. The combined dataset has
the following variables: **dumpster, month, year, date, weight_tons,
volume_cubic_yards, plastic_bottles, polystyrene, cigarette_butts,
glass_bottles, plastic_bags, wrappers, sports_balls, wheel_name,
homes_powered**. Key variables include the total weight_tons for each
haul, as well as counts of specific items like plastic_bottles,
polystyrene, and cigarette_butts.

## Problem 3

### Read in dataset Zip_codes and ZORI

``` r
zip_codes <- read_csv("./zillow_data/Zip Codes.csv")
```

    ## Rows: 322 Columns: 7
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (4): County, County Code, File Date, Neighborhood
    ## dbl (3): State FIPS, County FIPS, ZipCode
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
zori <- read_csv("./zillow_data/Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv")
```

    ## Rows: 149 Columns: 125
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr   (6): RegionType, StateName, State, City, Metro, CountyName
    ## dbl (119): RegionID, SizeRank, RegionName, 2015-01-31, 2015-02-28, 2015-03-3...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

### Clean dataset Zip_codes

``` r
zip_codes_clean <- zip_codes %>%
  janitor::clean_names() %>%
  select(zip_code, county, neighborhood) %>%
  distinct()
```

### Clean dataset ZORI

``` r
zori_clean <- zori %>%
  rename(zip = RegionName)%>%
  pivot_longer(
    cols = !RegionID:CountyName,  
    names_to = "date",
    values_to = "zori"
  ) %>%
  mutate(
    date = ymd(date),
    zip = as.integer(zip)) %>%
  select(zip, CountyName, date, zori)
```

### Merge Zip_codes with ZORI.

``` r
zori_merged <- zori_clean |>
  left_join(zip_codes_clean, by = c("zip" = "zip_code"),relationship = "many-to-many") %>%
  select(date,zip,CountyName,neighborhood,zori)
```

### Briefly describe the resulting zori_merged dataset.

The resulting *tidy* dataset **`zori_merged`** contains **17516** total
observations. The dataset includes **149** unique ZIP codes and **42**
unique neighborhoods across the five boroughs of New York City.

There are some ZIP codes apeear in the ZIP code dataset but not in the
Zillow Rental Price dataset, such as, **10464, 10474, 10475, 10499,
10550**.

These ZIP codes are often excluded because they may correspond to
invalid information. For example, the ZIP codes are in fact
**non-residential areas** (large commercial or industrial zones) or
**P.O. boxes** numbers.

### Rental Price Fluctuation

``` r
covid <- zori_merged %>%
  filter(date %in% c("2020-01-31", "2021-01-31")) %>%
  pivot_wider(
    names_from = date,
    values_from = zori,
    values_fn = mean) %>%
  mutate(drop = `2021-01-31` - `2020-01-31`) %>%
  arrange(drop) %>%
  slice_head(n = 10) %>%
  select(zip, CountyName, neighborhood, `2020-01-31`, `2021-01-31`, drop)

covid
```

    ## # A tibble: 10 × 6
    ##      zip CountyName      neighborhood            `2020-01-31` `2021-01-31`  drop
    ##    <dbl> <chr>           <chr>                          <dbl>        <dbl> <dbl>
    ##  1 10007 New York County Lower Manhattan                6334.        5422. -913.
    ##  2 10069 New York County <NA>                           4623.        3875. -748.
    ##  3 10009 New York County Lower East Side                3406.        2692. -714.
    ##  4 10016 New York County Gramercy Park and Murr…        3731.        3019. -712.
    ##  5 10001 New York County Chelsea and Clinton            4108.        3398. -710.
    ##  6 10002 New York County Lower East Side                3645.        2935. -710.
    ##  7 10004 New York County Lower Manhattan                3150.        2444. -706.
    ##  8 10038 New York County Lower Manhattan                3573.        2876. -698.
    ##  9 10012 New York County Greenwich Village and …        3629.        2942. -686.
    ## 10 10010 New York County Gramercy Park and Murr…        3697.        3012. -685.

### Comments on Rental Price Fluctuation

From the table, we could observe that rental prices fluctuated
dramatically during the COVID-19 pandemic.  
Comparing January 2021 to January 2020 across all ZIP codes, the largest
decline was in ZIP 10007 Lower Manhattan from \$6334 to \$5422 resulting
a drop of \$913. Second large drop happened in ZIP 10069 with about
\$748, following with a \$714 drop in ZIP 10009 Lower East Side.

Other borough neighborhoods, such as Queens, Bronx, Staten Island, are
not in the top 10, suggesting less fluctuations in these areas.
